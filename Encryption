s[len] = '\0';
int rows = floor(sqrt(len));
int cols = ceil(sqrt(len));
if (rows * cols < len) rows++;
char* result = malloc(len + cols + 1);
int pos = 0;
for (int c = 0; c < cols; c++) {
    for (int r = 0; r < rows; r++) {
        int idx = r * cols + c;
        if (idx < len) result[pos++] = s[idx];
    }
    if (c < cols - 1) result[pos++] = ' ';
}
result[pos] = '\0';
return result;
